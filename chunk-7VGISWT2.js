import{a as V}from"./chunk-XKNWOXYO.js";import"./chunk-XCEYEA5J.js";import{b as M}from"./chunk-74MSF4LX.js";import"./chunk-XHS7ECCB.js";import{$ as y,$a as L,La as w,Sb as F,T as v,Wa as b,Wb as N,Xb as k,Y as m,Ya as h,Z as p,_ as E,a as _,ab as S,b as g,bb as T,cb as n,db as r,eb as C,fb as O,ga as u,gb as x,hb as f,nb as s,ob as P,pb as d,wa as l,wb as I,xb as D,zb as R}from"./chunk-FJDYQ5PW.js";var G=(i,t,e)=>({"bg-yellow-100 text-yellow-800":i,"bg-green-100 text-green-800":t,"bg-red-100 text-red-800":e}),$=(i,t)=>t._id;function A(i,t){i&1&&(n(0,"div",2),C(1,"div",6),r())}function z(i,t){i&1&&(n(0,"div",3),s(1," Failed to load offers. Please try again later. "),r())}function B(i,t){i&1&&(n(0,"div",4),s(1,"No offers found for this post."),r())}function J(i,t){if(i&1){let e=O();n(0,"div",20)(1,"button",22),x("click",function(){m(e);let o=f().$implicit,c=f(2);return p(c.acceptOffer(o._id))}),s(2," Accept "),r(),n(3,"button",23),x("click",function(){m(e);let o=f().$implicit,c=f(2);return p(c.rejectOffer(o._id))}),s(4," Reject "),r()()}}function H(i,t){if(i&1&&(n(0,"div",21),s(1),r()),i&2){let e=f().$implicit;l(),d(" This offer has been ",e.status,". ")}}function U(i,t){if(i&1){let e=O();n(0,"div",7)(1,"button",8),x("click",function(){let o=m(e).$implicit,c=f(2);return p(c.removeOffer(o._id))}),E(),n(2,"svg",9),C(3,"path",10),r()(),y(),n(4,"div",11)(5,"div",12),s(6),r(),n(7,"div",13)(8,"p",14),s(9),r(),n(10,"p",15),s(11),r()()(),n(12,"div",16)(13,"p")(14,"span",17),s(15),D(16,"currency"),r()(),n(17,"p",18),s(18," Status: "),n(19,"span",19),s(20),r()()(),b(21,J,5,0,"div",20)(22,H,2,1,"div",21),r()}if(i&2){let e=t.$implicit;l(6),d(" ",e.customer.fname," "),l(3),d(" ",e.customer.fname," "),l(2),d(" ",e.message," "),l(4),P(R(16,7,e.amount,"USD")),l(4),T("ngClass",I(10,G,e.status==="PENDING",e.status==="ACCEPTED",e.status==="REJECTED")),l(),d(" ",e.status," "),l(),h(e.status==="PENDING"?21:22)}}function q(i,t){if(i&1&&(n(0,"div",5),L(1,U,23,14,"div",7,$),r()),i&2){let e=f();l(),S(e.offers())}}var j=class i{offerService=v(V);route=v(M);offers=u([]);isLoading=u(!0);hasError=u(!1);ngOnInit(){this.displayPost()}displayPost(){this.route.paramMap.subscribe(t=>{let e=t.get("postId");e?this.fetchOffers(e):(this.isLoading.set(!1),this.hasError.set(!0))})}fetchOffers(t){this.isLoading.set(!0),this.hasError.set(!1),this.offerService.getAllOffersForPost(t).subscribe({next:e=>{this.offers.set(e),this.isLoading.set(!1)},error:()=>{this.isLoading.set(!1),this.hasError.set(!0)}})}removeOffer(t){this.offers.update(e=>e.filter(a=>a._id!==t))}acceptOffer(t){this.offerService.respondToOffer({action:"ACCEPTED"}).subscribe({next:e=>{this.offers.update(a=>a.map(o=>o._id===t?g(_({},o),{status:e.data.status}):o))},error:()=>{alert("Failed to accept offer. Please try again.")}})}rejectOffer(t){this.offerService.respondToOffer({action:"REJECTED"}).subscribe({next:e=>{this.offers.update(a=>a.map(o=>o._id===t?g(_({},o),{status:e.data.status}):o))},error:()=>{alert("Failed to reject offer. Please try again.")}})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=w({type:i,selectors:[["app-offers-list"]],decls:7,vars:1,consts:[[1,"container","mx-auto","mt-6","px-4"],[1,"text-2xl","font-semibold","text-gray-800","mb-4"],[1,"flex","justify-center","py-10"],[1,"text-center","text-red-500","font-medium"],[1,"text-center","text-gray-500","font-medium"],[1,"grid","gap-4","md:grid-cols-2","lg:grid-cols-3"],[1,"w-8","h-8","border-4","border-blue-500","border-t-transparent","rounded-full","animate-spin"],[1,"relative","border","border-gray-200","rounded-2xl","shadow-sm","p-4","bg-white","hover:shadow-md","transition-all"],["type","button",1,"absolute","top-2","right-2","p-1","bg-gray-100","border","border-gray-300","rounded-full","hover:bg-gray-200",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"w-3","h-3"],["fill-rule","evenodd","d",`M4.293 4.293a1 1 0 011.414 0L10 
                8.586l4.293-4.293a1 1 0 
                111.414 1.414L11.414 10l4.293 
                4.293a1 1 0 01-1.414 
                1.414L10 11.414l-4.293 
                4.293a1 1 0 01-1.414-1.414L8.586 
                10 4.293 5.707a1 1 0 010-1.414z`,"clip-rule","evenodd"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-full","bg-blue-100","flex","items-center","justify-center","text-blue-700","font-bold","uppercase"],[1,"flex-1"],[1,"font-semibold","text-gray-800"],[1,"text-sm","text-gray-500","truncate"],[1,"mt-3","flex","items-center","justify-between","text-sm","text-gray-600"],[1,"font-medium","text-green-600"],[1,"capitalize"],[1,"px-2","py-0.5","text-xs","rounded-full",3,"ngClass"],[1,"mt-4","flex","gap-2"],[1,"mt-4","text-center","text-sm","text-gray-500","italic"],[1,"flex-1","bg-green-500","text-white","py-2","rounded-lg","hover:bg-green-600","transition-all",3,"click"],[1,"flex-1","bg-red-500","text-white","py-2","rounded-lg","hover:bg-red-600","transition-all",3,"click"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"h2",1),s(2,"Offers"),r(),b(3,A,2,0,"div",2)(4,z,2,0,"div",3)(5,B,2,0,"div",4)(6,q,3,0,"div",5),r()),e&2&&(l(3),h(a.isLoading()?3:a.hasError()?4:a.offers().length===0?5:6))},dependencies:[k,F,N],encapsulation:2})};export{j as OffersList};
