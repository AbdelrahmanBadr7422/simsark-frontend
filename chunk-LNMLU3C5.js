import{a as P}from"./chunk-RLDTOJEW.js";import{a as T,b as s,c as I,d as A,e as M,f as V,g as D,h as q,i as L,j as R,k,l as G,m as O}from"./chunk-XOG22YQB.js";import"./chunk-XCEYEA5J.js";import{d as N}from"./chunk-74MSF4LX.js";import"./chunk-XHS7ECCB.js";import{$a as B,La as _,T as g,Wa as d,Xb as S,Ya as m,Za as y,a as E,ab as F,b as w,bb as x,cb as r,db as i,eb as u,gb as v,hb as p,nb as n,ob as c,ua as C,wa as a}from"./chunk-FJDYQ5PW.js";function U(){return e=>{let l=["Apartment","Villa","Studio","Land"],t=e.value;return l.includes(t)?null:{propertyTypeInvalid:!0}}}function j(e,l){if(e&1&&(r(0,"div",10),n(1),i()),e&2){let t=p();a(),c(t.getFieldError("title"))}}function z(e,l){if(e&1&&(r(0,"div",10),n(1),i()),e&2){let t=p();a(),c(t.getFieldError("description"))}}function W(e,l){if(e&1&&u(0,"img",16),e&2){let t=l.$implicit;x("src",t,C)}}function H(e,l){if(e&1&&(r(0,"div",10),n(1),i()),e&2){let t=p();a(),c(t.getFieldError("propertyType"))}}function J(e,l){if(e&1&&(r(0,"div",10),n(1),i()),e&2){let t=p();a(),c(t.getFieldError("price"))}}function K(e,l){if(e&1&&(r(0,"div",10),n(1),i()),e&2){let t=p();a(),c(t.getFieldError("area"))}}function Q(e,l){if(e&1&&(r(0,"div",10),n(1),i()),e&2){let t=p();a(),c(t.getFieldError("rooms"))}}function X(e,l){if(e&1&&(r(0,"div",10),n(1),i()),e&2){let t=p();a(),c(t.getFieldError("bathrooms"))}}function Y(e,l){if(e&1&&(r(0,"div",25),n(1),i()),e&2){let t=p();a(),c(t.serverErrorMsg)}}function Z(e,l){if(e&1&&(r(0,"div",26),n(1),i()),e&2){let t=p();a(),c(t.successMessage)}}function ee(e,l){e&1&&(r(0,"span",28),n(1,"Creating Post..."),i())}function te(e,l){e&1&&n(0," Add Post ")}var $=class e{postForm;isLoading=!1;serverErrorMsg="";successMessage="";previewImages=[];fb=g(G);router=g(N);postService=g(P);ngOnInit(){this.postForm=this.fb.group({title:["",[s.required,s.minLength(5)]],description:["",[s.required,s.minLength(10)]],propertyType:["",[s.required,U()]],price:["",[s.required,s.min(1)]],area:["",[s.required,s.min(1)]],rooms:["",[s.required,s.min(1)]],bathrooms:["",[s.required,s.min(1)]],images:[""]})}onImageSelect(l){let t=l.target.files;if(!t?.length)return;this.previewImages=[];let o=[];for(let b of t){let f=new FileReader;f.onload=h=>{this.previewImages.push(h.target.result),o.push(h.target.result),this.postForm.patchValue({images:o})},f.readAsDataURL(b)}}addNewPost(){if(this.postForm.invalid){this.postForm.markAllAsTouched();return}this.isLoading=!0,this.serverErrorMsg="",this.successMessage="";let l=this.postForm.value,t=w(E({},l),{area:+l.area,rooms:+l.rooms,bathrooms:+l.bathrooms,images:this.previewImages});this.postService.createPost(t).subscribe({next:o=>{console.log("CREATE NEW POST"),this.isLoading=!1,this.successMessage="Post created successfully! Redirecting...",this.postForm.reset(),this.previewImages=[],setTimeout(()=>this.router.navigate(["/explore"]),1e3)},error:()=>{this.isLoading=!1,this.serverErrorMsg="Something went wrong. Please try again."}})}getFieldError(l){let t=this.postForm.get(l);if(!t||!t.touched||!t.errors)return null;let o=t.errors;return o.required?"This field is required.":o.minlength?`Minimum length is ${o.minlength.requiredLength}.`:o.min?`Value must be at least ${o.min.min}.`:o.invalidPropertyType?"Invalid property type.":null}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=_({type:e,selectors:[["app-new-post"]],decls:66,vars:12,consts:[[1,"min-h-screen","flex","flex-col","lg:flex-row","bg-[#F8F4F0]"],[1,"hidden","lg:block","w-2","bg-[#E5D5C5]","relative"],["id","progressBar",1,"absolute","left-0","top-0","w-full","bg-[#2B1B12]","rounded-r","transition-all","duration-300",2,"height","0%"],[1,"flex-1","flex","items-center","justify-center","px-6","md:px-12","py-12"],[1,"w-full","max-w-lg","bg-white","shadow-lg","rounded-2xl","p-8"],[1,"text-3xl","font-bold","mb-8","text-center","text-[#2B1B12]"],[1,"space-y-6","overflow-y-auto",3,"ngSubmit","formGroup"],[1,"relative"],["type","text","id","title","formControlName","title","placeholder"," ",1,"peer","w-full","bg-transparent","border-b-2","border-[#B99F8A]","py-3","text-[#2B1B12]","focus:outline-none","focus:border-[#2B1B12]"],["for","title",1,"absolute","left-0","top-3","text-[#6B5B4D]","text-sm","transition-all","peer-placeholder-shown:top-3","peer-placeholder-shown:text-base","peer-focus:top-0","peer-focus:text-xs","peer-focus:text-[#2B1B12]"],[1,"text-red-600","text-sm","mt-1"],["id","description","formControlName","description","rows","3","placeholder"," ",1,"peer","w-full","bg-transparent","border-b-2","border-[#B99F8A]","py-3","text-[#2B1B12]","focus:outline-none","focus:border-[#2B1B12]"],["for","description",1,"absolute","left-0","top-3","text-[#6B5B4D]","text-sm","transition-all","peer-placeholder-shown:top-3","peer-placeholder-shown:text-base","peer-focus:top-0","peer-focus:text-xs","peer-focus:text-[#2B1B12]"],[1,"block","mb-2","text-[#6B5B4D]","text-sm","font-medium"],["type","file","multiple","","accept","image/*",1,"block","w-full","text-sm","text-[#2B1B12]","border","border-[#B99F8A]","rounded-lg","cursor-pointer","bg-[#F8F4F0]","focus:outline-none",3,"change"],[1,"flex","flex-wrap","gap-3","mt-3"],[1,"w-24","h-24","rounded-lg","object-cover","shadow",3,"src"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-[#6B5B4D]","text-sm","font-medium","mb-1"],["formControlName","propertyType",1,"w-full","border-b-2","border-[#B99F8A]","py-2","bg-transparent","focus:outline-none","focus:border-[#2B1B12]"],["value",""],["type","number","formControlName","price",1,"w-full","border-b-2","border-[#B99F8A]","py-2","bg-transparent","focus:outline-none","focus:border-[#2B1B12]"],["type","text","formControlName","area",1,"w-full","border-b-2","border-[#B99F8A]","py-2","bg-transparent","focus:outline-none","focus:border-[#2B1B12]"],["type","text","formControlName","rooms",1,"w-full","border-b-2","border-[#B99F8A]","py-2","bg-transparent","focus:outline-none","focus:border-[#2B1B12]"],["type","text","formControlName","bathrooms",1,"w-full","border-b-2","border-[#B99F8A]","py-2","bg-transparent","focus:outline-none","focus:border-[#2B1B12]"],[1,"text-red-600","text-center"],[1,"text-green-600","text-center"],["type","submit",1,"w-full","bg-[#2B1B12]","hover:bg-[#3b261a]","transition-all","text-white","font-semibold","py-3","rounded-lg","disabled:opacity-50",3,"disabled"],[1,"animate-pulse"]],template:function(t,o){t&1&&(r(0,"section",0)(1,"div",1),u(2,"div",2),i(),r(3,"div",3)(4,"div",4)(5,"h2",5),n(6,"Create New Post"),i(),r(7,"form",6),v("ngSubmit",function(){return o.addNewPost()}),r(8,"div",7),u(9,"input",8),r(10,"label",9),n(11," Title "),i(),d(12,j,2,1,"div",10),i(),r(13,"div",7),u(14,"textarea",11),r(15,"label",12),n(16," Description "),i(),d(17,z,2,1,"div",10),i(),r(18,"div")(19,"label",13),n(20,"Upload Images"),i(),r(21,"input",14),v("change",function(f){return o.onImageSelect(f)}),i(),r(22,"div",15),B(23,W,1,1,"img",16,y),i()(),r(25,"div",17)(26,"div")(27,"label",18),n(28,"Property Type"),i(),r(29,"select",19)(30,"option",20),n(31,"Select..."),i(),r(32,"option"),n(33,"Apartment"),i(),r(34,"option"),n(35,"Villa"),i(),r(36,"option"),n(37,"Studio"),i(),r(38,"option"),n(39,"Land"),i()(),d(40,H,2,1,"div",10),i(),r(41,"div")(42,"label",18),n(43,"Price ($)"),i(),u(44,"input",21),d(45,J,2,1,"div",10),i(),r(46,"div")(47,"label",18),n(48,"Area (m\xB2)"),i(),u(49,"input",22),d(50,K,2,1,"div",10),i(),r(51,"div")(52,"label",18),n(53,"Rooms"),i(),u(54,"input",23),d(55,Q,2,1,"div",10),i(),r(56,"div")(57,"label",18),n(58,"Bathrooms"),i(),u(59,"input",24),d(60,X,2,1,"div",10),i()(),d(61,Y,2,1,"div",25),d(62,Z,2,1,"div",26),r(63,"button",27),d(64,ee,2,0,"span",28)(65,te,1,0),i()()()()()),t&2&&(a(7),x("formGroup",o.postForm),a(5),m(o.getFieldError("title")?12:-1),a(5),m(o.getFieldError("description")?17:-1),a(6),F(o.previewImages),a(17),m(o.getFieldError("propertyType")?40:-1),a(5),m(o.getFieldError("price")?45:-1),a(5),m(o.getFieldError("area")?50:-1),a(5),m(o.getFieldError("rooms")?55:-1),a(5),m(o.getFieldError("bathrooms")?60:-1),a(),m(o.serverErrorMsg?61:-1),a(),m(o.successMessage?62:-1),a(),x("disabled",o.postForm.invalid||o.isLoading),a(),m(o.isLoading?64:65))},dependencies:[S,O,M,R,k,T,V,L,I,A,D,q],encapsulation:2})};export{$ as NewPost};
