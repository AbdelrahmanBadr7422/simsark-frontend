import{a as H}from"./chunk-XKNWOXYO.js";import{a as q}from"./chunk-RLDTOJEW.js";import{a as L,b as s,c as N,d as $,e as j,f as A,g as U,h as G,l as z,m as J}from"./chunk-XOG22YQB.js";import"./chunk-XCEYEA5J.js";import{b as V,e as R}from"./chunk-74MSF4LX.js";import"./chunk-XHS7ECCB.js";import{$a as M,K as h,La as E,T as g,Vb as I,Wa as b,Xb as F,Y as u,Ya as _,Z as p,Za as D,a as y,ab as O,b as P,bb as v,cb as i,db as t,eb as l,fb as w,gb as x,hb as f,j as C,nb as o,pb as d,ua as S,vb as T,wa as a,xb as B,zb as k}from"./chunk-FJDYQ5PW.js";var Q=r=>["/offers/",r];function W(r,n){if(r&1){let e=w();i(0,"div",4)(1,"button",22),x("click",function(){u(e);let c=f(2);return p(c.openOfferModal())}),o(2," Make an Offer "),t()()}}function X(r,n){if(r&1&&(i(0,"a",5),o(1," Show Offers "),t()),r&2){let e=f(2);v("routerLink",T(1,Q,e.currentPost._id))}}function Y(r,n){if(r&1&&l(0,"img",8),r&2){let e=n.$implicit;v("src",e,S)}}function Z(r,n){if(r&1){let e=w();i(0,"div",20)(1,"button",23),x("click",function(){u(e);let c=f(2);return p(c.openEditModal())}),o(2," Edit "),t(),i(3,"button",24),x("click",function(){u(e);let c=f(2);return p(c.confirmDelete())}),o(4," Delete "),t()()}}function ee(r,n){if(r&1){let e=w();i(0,"div",21)(1,"div",25)(2,"h3",26),o(3,"Make an Offer"),t(),i(4,"form",27),x("ngSubmit",function(){u(e);let c=f(2);return p(c.submitOffer())}),i(5,"div")(6,"label",28),o(7,"Amount ($)"),t(),l(8,"input",29),t(),i(9,"div")(10,"label",28),o(11,"Message"),t(),l(12,"textarea",30),t(),i(13,"div",31)(14,"button",32),x("click",function(){u(e);let c=f(2);return p(c.closeOfferModal())}),o(15," Cancel "),t(),i(16,"button",33),o(17," Submit "),t()()()()()}if(r&2){let e=f(2);a(4),v("formGroup",e.offerForm)}}function te(r,n){if(r&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),o(4),t(),i(5,"p",3),o(6),t()(),b(7,W,3,0,"div",4)(8,X,2,3,"a",5),t(),i(9,"div",6)(10,"div",7),M(11,Y,1,1,"img",8,D),t()(),i(13,"div")(14,"h2",9),o(15,"Property Details"),t(),i(16,"p",10),o(17),t(),i(18,"div",11)(19,"div",12),l(20,"i",13),i(21,"strong",14),o(22,"Owner:"),t(),o(23),t(),i(24,"div",12),l(25,"i",15),i(26,"strong",14),o(27,"Type:"),t(),o(28),t(),i(29,"div",12),l(30,"i",16),i(31,"strong",14),o(32,"Area:"),t(),o(33),t(),i(34,"div",12),l(35,"i",17),i(36,"strong",14),o(37,"Rooms:"),t(),o(38),t(),i(39,"div",12),l(40,"i",18),i(41,"strong",14),o(42,"Bathrooms:"),t(),o(43),t(),i(44,"div",12),l(45,"i",19),i(46,"strong",14),o(47,"Last Updated:"),t(),o(48),B(49,"date"),t()(),b(50,Z,5,0,"div",20),t()(),b(51,ee,18,1,"div",21)),r&2){let e=f();a(4),d("$",e.currentPost.price),a(2),d(" ",e.currentPost.title," "),a(),_(e.postOwner?8:7),a(4),O(e.currentPost.images),a(6),d(" ",e.currentPost.description||"No description available."," "),a(6),d(" ",e.currentPost.owner.email||"Unknown Owner"," "),a(5),d(" ",e.currentPost.propertyType||"N/A"," "),a(5),d(" ",e.currentPost.area," m\xB2 "),a(5),d(" ",e.currentPost.rooms," "),a(5),d(" ",e.currentPost.bathrooms," "),a(5),d(" ",k(49,12,e.currentPost.updatedAt,"medium")," "),a(2),_(e.postOwner?50:-1),a(),_(e.showOfferModal?51:-1)}}var K=class r{postService=g(q);offerService=g(H);route=g(V);fb=g(z);destroy$=new C;currentPost;isLoading=!0;hasError=!1;postOwner=!1;showDeleteConfirm=!1;showEditModal=!1;showOfferModal=!1;showToast=!1;toastMessage="";toastType="success";updateForm=this.fb.group({title:["",[s.required,s.minLength(5)]],description:["",[s.required,s.minLength(10)]],price:[0,[s.required,s.min(1)]],area:[0,[s.required,s.min(1)]],rooms:[0,[s.required,s.min(1)]],bathrooms:[0,[s.required,s.min(1)]]});offerForm=this.fb.group({amount:[0,[s.required,s.min(1)]],message:["",[s.required,s.minLength(5)]]});ngOnInit(){this.displayPost()}displayPost(){this.route.paramMap.pipe(h(this.destroy$)).subscribe(n=>{let e=n.get("postId");e?this.fetchPostDetails(e):(this.isLoading=!1,this.hasError=!0)})}fetchPostDetails(n){this.isLoading=!0,this.hasError=!1,this.postService.getSinglePost(n).pipe(h(this.destroy$)).subscribe({next:e=>{this.currentPost=e.data,this.isLoading=!1;let m=localStorage.getItem("userData");this.postOwner=!!m&&m.includes(this.currentPost.owner._id),this.updateForm.patchValue(this.currentPost)},error:()=>{this.hasError=!0,this.isLoading=!1}})}openOfferModal(){this.showOfferModal=!0}closeOfferModal(){this.showOfferModal=!1}submitOffer(){if(this.offerForm.invalid||!this.currentPost)return;let n={postId:this.currentPost._id,amount:this.offerForm.value.amount,message:this.offerForm.value.message};this.offerService.addOfferService(n).subscribe({next:e=>{this.showOfferModal=!1,this.showToastMessage(" Offer sent successfully!","success")},error:()=>this.showToastMessage("Failed to send offer","error")})}confirmDelete(){this.showDeleteConfirm=!0}cancelDelete(){this.showDeleteConfirm=!1}deletePost(){this.currentPost&&this.postService.deletePost(this.currentPost._id).pipe(h(this.destroy$)).subscribe({next:()=>{this.showDeleteConfirm=!1,this.showToastMessage("Post deleted successfully \u{1F5D1}\uFE0F","success"),setTimeout(()=>window.history.back(),1500)},error:()=>this.showToastMessage("Failed to delete post ","error")})}openEditModal(){this.showEditModal=!0}closeEditModal(){this.showEditModal=!1}savePostUpdate(){if(this.updateForm.invalid||!this.currentPost)return;let n=P(y({},this.updateForm.value),{propertyType:this.currentPost.propertyType});this.postService.updatePost(this.currentPost._id,n).pipe(h(this.destroy$)).subscribe({next:e=>{this.currentPost=e.data,this.showEditModal=!1,this.showToastMessage(" Post updated successfully!","success")},error:()=>this.showToastMessage("Failed to update post ","error")})}showToastMessage(n,e){this.toastMessage=n,this.toastType=e,this.showToast=!0,setTimeout(()=>this.showToast=!1,2500)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-post-details"]],decls:1,vars:1,consts:[[1,"bg-white","rounded-2xl","shadow-lg","overflow-hidden","p-6","md:p-10"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","mb-6","gap-4"],[1,"text-4xl","font-extrabold","text-[#2B1B12]"],[1,"text-lg","text-gray-600","font-medium","mt-1"],[1,"flex","items-center","gap-3","w-full","sm:w-auto"],[1,"font-bold","text-[#2B1B12]","hover:underline","text-sm","sm:text-base",3,"routerLink"],[1,"relative","w-full","border","border-gray-200","rounded-xl","overflow-hidden","shadow-sm","mb-8","bg-gray-50"],[1,"flex","overflow-x-auto","snap-x","snap-mandatory","scroll-smooth"],["alt","Property Image",1,"h-80","w-full","object-cover","snap-center","flex-shrink-0",3,"src"],[1,"text-2xl","font-bold","text-[#2B1B12]","mb-3"],[1,"text-gray-700","text-lg","leading-relaxed","mb-6"],[1,"grid","grid-cols-2","md:grid-cols-3","gap-x-6","gap-y-4","text-gray-800","text-base"],[1,"flex","items-center","gap-2"],[1,"fa-solid","fa-user","text-[#2B1B12]"],[1,"font-semibold","text-gray-700"],[1,"fa-solid","fa-building","text-[#2B1B12]"],[1,"fa-solid","fa-ruler-combined","text-[#2B1B12]"],[1,"fa-solid","fa-bed","text-[#2B1B12]"],[1,"fa-solid","fa-bath","text-[#2B1B12]"],[1,"fa-solid","fa-clock","text-[#2B1B12]"],[1,"pt-8","flex","flex-col","sm:flex-row","gap-3","justify-between"],[1,"fixed","inset-0","bg-black","bg-opacity-40","flex","items-center","justify-center","z-50"],[1,"bg-[#2B1B12]","hover:bg-[#3b261a]","text-white","px-5","py-2","rounded-lg","transition","font-semibold",3,"click"],[1,"flex-1","bg-amber-700","hover:bg-amber-800","text-white","py-2","rounded","transition",3,"click"],[1,"flex-1","bg-red-700","hover:bg-red-800","text-white","py-2","rounded","transition",3,"click"],[1,"bg-white","rounded-xl","shadow-lg","w-full","max-w-md","p-6"],[1,"text-xl","font-bold","text-center","mb-4"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","mb-1"],["type","number","formControlName","amount",1,"w-full","border","rounded","p-2","focus:outline-none","focus:ring","focus:ring-amber-300"],["rows","3","formControlName","message",1,"w-full","border","rounded","p-2","focus:outline-none","focus:ring","focus:ring-amber-300"],[1,"flex","justify-end","gap-4","pt-4"],["type","button",1,"px-4","py-2","bg-gray-300","hover:bg-gray-400","rounded-lg",3,"click"],["type","submit",1,"px-4","py-2","bg-[#2B1B12]","hover:bg-[#3b261a]","text-white","rounded-lg","disabled:opacity-50"]],template:function(e,m){e&1&&b(0,te,52,15),e&2&&_(m.currentPost?0:-1)},dependencies:[F,J,j,L,A,N,$,U,G,R,I],encapsulation:2})};export{K as PostDetails};
